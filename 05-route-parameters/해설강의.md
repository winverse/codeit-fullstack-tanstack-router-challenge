# 챌린지 해설: 동적 라우트 파라미터 실습

이번 챌린지의 목표는 `useParams` 훅을 사용하여 URL의 동적 파라미터(`productId`)를 가져와, 이를 기반으로 특정 상품의 상세 정보를 표시하는 페이지를 완성하는 것입니다.

## 1. `useParams`로 파라미터 추출하기

가장 먼저, 컴포넌트가 현재 어떤 상품을 보여줘야 하는지 알아야 합니다. 이 정보는 URL의 `productId` 부분에 담겨 있습니다. TanStack Router의 `useParams` 훅을 사용하면 이 값을 쉽게 가져올 수 있습니다.

`from` 옵션에 라우트의 전체 경로(`'/products/$productId'`)를 명시해주면, TypeScript가 파라미터 객체의 타입을 정확히 추론하여 코드 자동 완성과 타입 안정성을 높여줍니다.

```jsx
// src/routes/products.$productId.jsx

// ...

function ProductDetail() {
  // `useParams`를 사용하여 productId를 추출합니다.
  const { productId } = useParams({ from: '/products/$productId' });

  // ...
}
```

## 2. 상품 데이터 검색 및 예외 처리

이제 가져온 `productId`를 사용하여 `products` 배열에서 해당 상품을 찾아야 합니다. 여기서 중요한 점은 `useParams`로 가져온 값은 항상 **문자열(string)**이라는 것입니다. 따라서 `products` 배열의 `id`(숫자)와 비교하기 위해 `parseInt()` 함수로 타입을 변환해주어야 합니다.

또한, 사용자가 존재하지 않는 ID(예: `/products/99`)로 접근할 경우를 대비하여, `product`가 `undefined`일 때를 처리하는 로직이 반드시 필요합니다. 이 경우, 사용자에게 상품이 없음을 알리는 UI를 보여주고, 더 이상 아래 코드가 실행되지 않도록 `return`합니다.

```jsx
// src/routes/products.$productId.jsx

// ...

function ProductDetail() {
  const { productId } = useParams({ from: '/products/$productId' });

  // productId를 숫자로 변환하여 일치하는 상품을 찾습니다.
  const product = products.find((p) => p.id === parseInt(productId));

  // 상품을 찾지 못한 경우에 대한 예외 처리
  if (!product) {
    return (
      <div className="page-content">
        <h1>제품을 찾을 수 없습니다</h1>
        <p>ID가 '{productId}'인 제품이 존재하지 않습니다.</p>
        <Link to="/products" className="btn">
          &larr; 제품 목록으로 돌아가기
        </Link>
      </div>
    );
  }

  // ... (상품 정보 렌더링)
}
```

## 전체 모범 답안

위의 단계들을 모두 적용한 전체 코드는 다음과 같습니다.

```jsx
// src/routes/products.$productId.jsx
import { createFileRoute, Link, useParams } from '@tanstack/react-router';

const products = [
  { id: 1, name: '노트북', category: 'electronics', price: 1200, description: '고성능 노트북으로 업무와 게임 모두에 적합합니다.' },
  { id: 2, name: '스마트폰', category: 'electronics', price: 800, description: '최신 기술이 집약된 프리미엄 스마트폰입니다.' },
  { id: 3, name: '헤드폰', category: 'electronics', price: 200, description: '뛰어난 음질과 편안한 착용감을 제공합니다.' },
  { id: 4, name: '책상', category: 'furniture', price: 300, description: '견고하고 넓은 작업 공간을 제공하는 책상입니다.' },
  { id: 5, name: '의자', category: 'furniture', price: 150, description: '인체공학적 디자인으로 장시간 사용에도 편안합니다.' },
];

export const Route = createFileRoute('/products/$productId')({
  component: ProductDetail,
});

function ProductDetail() {
  const { productId } = useParams({ from: '/products/$productId' });
  const product = products.find((p) => p.id === parseInt(productId));

  if (!product) {
    return (
      <div className="page-content">
        <h1>제품을 찾을 수 없습니다</h1>
        <p>ID가 '{productId}'인 제품이 존재하지 않습니다.</p>
        <Link to="/products" className="btn">
          &larr; 제품 목록으로 돌아가기
        </Link>
      </div>
    );
  }

  return (
    <div className="page-content">
      <h1 className="product-name">{product.name}</h1>
      <p className="product-category">카테고리: {product.category}</p>
      <p className="product-price">${product.price}</p>
      <p className="product-description">{product.description}</p>
      <Link to="/products" className="btn" style={{ marginTop: '2rem' }}>
        &larr; 제품 목록으로 돌아가기
      </Link>
    </div>
  );
}
```

## 핵심 정리

-   **`useParams`**: URL의 동적 세그먼트 값을 가져오는 가장 기본적인 방법입니다.
-   **타입 변환**: URL 파라미터는 항상 문자열이므로, 숫자와 비교할 때는 `parseInt()`나 `Number()`를 사용해야 합니다.
-   **예외 처리**: 존재하지 않는 파라미터 값에 대한 처리는 사용자 경험을 위해 매우 중요합니다.

축하합니다! 이제 동적 라우트의 기본을 마스터했습니다.
